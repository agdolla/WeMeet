{"version":3,"sources":["app\\server.js"],"names":["getlocation","setlocation","deleteNotification","acceptFriendRequest","acceptActivityRequest","getNotificationData","likePost","unLikePost","likeActivity","unLikeActivity","changeUserInfo","ChangeAvatar","changeEmail","postComment","postStatus","createActivity","getPostFeedData","getActivityFeedData","getAllActivities","getAllPosts","getUserData","getActivityDetail","adpostComment","getMessages","postMessage","getSessionId","searchquery","signup","login","addFriend","sendJoinActivityRequest","sendInviteActivityRequest","moment","require","sendXHR","verb","resource","body","cb","errorCb","xhr","XMLHttpRequest","open","setRequestHeader","addEventListener","statusCode","status","timeout","send","JSON","stringify","Error","test","navigator","userAgent","geolocation","getCurrentPosition","position","coords","latitude","longitude","onload","parse","responseText","userId","location","id","user","undefined","notificationid","fromuser","feedItemId","activityId","data","img","author","comment","text","res","results","length","type","userData","_id","title","description","startTime","valueOf","endTime","detail","time","userid","sessionId","sender","target","targetid","querytext","email","username","password","fullname","authData","token","activityid"],"mappings":";;;;;;;;QAwEgBA,W,GAAAA,W;QAoBAC,W,GAAAA,W;QAMAC,kB,GAAAA,kB;QAMAC,mB,GAAAA,mB;QAMAC,qB,GAAAA,qB;QAMAC,mB,GAAAA,mB;QAMAC,Q,GAAAA,Q;QAOAC,U,GAAAA,U;QAOAC,Y,GAAAA,Y;QAOAC,c,GAAAA,c;QAOAC,c,GAAAA,c;QAMAC,Y,GAAAA,Y;QAMAC,W,GAAAA,W;QAOAC,W,GAAAA,W;QASAC,U,GAAAA,U;QAcAC,c,GAAAA,c;QAqBAC,e,GAAAA,e;QASAC,mB,GAAAA,mB;QAQAC,gB,GAAAA,gB;QAQAC,W,GAAAA,W;QAQAC,W,GAAAA,W;QAMAC,iB,GAAAA,iB;QAMAC,a,GAAAA,a;QASAC,W,GAAAA,W;QAMAC,W,GAAAA,W;QAUAC,Y,GAAAA,Y;QAQAC,W,GAAAA,W;QAOCC,M,GAAAA,M;QAUAC,K,GAAAA,K;QAcDC,S,GAAAA,S;QAQAC,uB,GAAAA,uB;QAQAC,yB,GAAAA,yB;;AAlVhB;;AAGA;;AAFA;AACA,IAAIC,SAASC,QAAQ,QAAR,CAAb;;;AAGA;;;;AAIA,SAASC,OAAT,CAAiBC,IAAjB,EAAuBC,QAAvB,EAAiCC,IAAjC,EAAuCC,EAAvC,EAA2CC,OAA3C,EAAoD;AAClD,MAAIC,MAAM,IAAIC,cAAJ,EAAV;AACAD,MAAIE,IAAJ,CAASP,IAAT,EAAeC,QAAf;AACAI,MAAIG,gBAAJ,CAAqB,eAArB,EAAsC,YAAY,4BAAlD;AACA;AACA;AACA;AACA;AACA;AACAH,MAAII,gBAAJ,CAAqB,MAArB,EAA6B,YAAW;AACtC,QAAIC,aAAaL,IAAIM,MAArB;AACA;AACA,QAAID,cAAc,GAAd,IAAqBA,aAAa,GAAtC,EAA2C;AACzC;AACA;AACAP,SAAGE,GAAH;AACD,KAJD,MAIO;AACL;AACA;AACA;AACA;AACA,UAAID,OAAJ,EAAa;AACX;AACAA,gBAAQM,UAAR;AACD;AACD;AACA;AACD;AACF,GAnBD;AAoBA;AACA;AACAL,MAAIO,OAAJ,GAAc,KAAd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAeV,IAAf,yCAAeA,IAAf;AACE,SAAK,WAAL;AACE;AACAG,UAAIQ,IAAJ;AACF;AACE,SAAK,QAAL;AACA;AACAR,UAAIG,gBAAJ,CAAqB,cAArB,EAAqC,0BAArC;AACAH,UAAIQ,IAAJ,CAASX,IAAT;AACF;AACE,SAAK,QAAL;AACA;AACAG,UAAIG,gBAAJ,CAAqB,cAArB,EAAqC,gCAArC;AACA;AACAH,UAAIQ,IAAJ,CAASC,KAAKC,SAAL,CAAeb,IAAf,CAAT;AACF;AACE;AACA,YAAM,IAAIc,KAAJ,CAAU,gCAA+Bd,IAA/B,yCAA+BA,IAA/B,EAAV,CAAN;AAjBJ;AAmBD;;AAEM,SAASrC,WAAT,CAAqBsC,EAArB,EAAwB;AAC7B,MAAI,aAAac,IAAb,CAAkBC,UAAUC,SAA5B,CAAJ,EAA2C;AACzC,WAAOhB,GAAG,OAAH,CAAP;AACD;AACD,MAAI,iBAAiBe,SAArB,EAAgC;AAC9BA,cAAUE,WAAV,CAAsBC,kBAAtB,CAAyC,UAAUC,QAAV,EAAoB;AAC3D,UAAIjB,MAAM,IAAIC,cAAJ,EAAV;AACAD,UAAIE,IAAJ,CAAS,KAAT,EACA,8DAA4De,SAASC,MAAT,CAAgBC,QAA5E,GAAqF,GAArF,GAAyFF,SAASC,MAAT,CAAgBE,SAAzG,GAAmH,cADnH;AAEApB,UAAIqB,MAAJ,GAAa,YAAW;AACtBvB,WAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,OAFD;AAGAvB,UAAIQ,IAAJ;AACD,KARD;AASD,GAVD,MAWI;AACFV,OAAG,kBAAH;AACD;AACF;;AAEM,SAASrC,WAAT,CAAqB+D,MAArB,EAA4BC,QAA5B,EAAqC;AAC1C/B,UAAQ,KAAR,EAAc,6BAA2B8B,MAAzC,EAAgDC,QAAhD,EAAyD,YAAI,CAC5D,CADD;AAED;;AAGM,SAAS/D,kBAAT,CAA4BgE,EAA5B,EAAgCC,IAAhC,EAAsC7B,EAAtC,EAAyC;AAC9CJ,UAAQ,QAAR,EAAiB,mBAAiBgC,EAAjB,GAAoB,GAApB,GAAwBC,IAAzC,EAA8CC,SAA9C,EAAwD,UAAC5B,GAAD,EAAO;AAC7DF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAAS5D,mBAAT,CAA6B+D,EAA7B,EAAgCC,IAAhC,EAAqC7B,EAArC,EAAwC;AAC7CJ,UAAQ,KAAR,EAAc,mBAAiBgC,EAAjB,GAAoB,GAApB,GAAwBC,IAAtC,EAA2CC,SAA3C,EAAqD,UAAC5B,GAAD,EAAO;AAC1DF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAAS3D,qBAAT,CAA+BiE,cAA/B,EAA8CC,QAA9C,EAAuDhC,EAAvD,EAA0D;AAC/DJ,UAAQ,KAAR,EAAc,qBAAmBmC,cAAnB,GAAkC,GAAlC,GAAsCC,QAApD,EAA6DF,SAA7D,EAAuE,UAAC5B,GAAD,EAAO;AAC5EF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAAS1D,mBAAT,CAA6B8D,IAA7B,EAAmC7B,EAAnC,EAAsC;AAC3CJ,UAAQ,KAAR,EAAc,WAASiC,IAAT,GAAc,eAA5B,EAA4CC,SAA5C,EAAsD,UAAC5B,GAAD,EAAO;AAC3DF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAASzD,QAAT,CAAkBiE,UAAlB,EAA8BJ,IAA9B,EAAoC7B,EAApC,EAAuC;AAC5CJ,UAAQ,KAAR,EAAe,eAAaqC,UAAb,GAAwB,YAAxB,GAAqCJ,IAApD,EACCC,SADD,EACY,UAAC5B,GAAD,EAAO;AAChBF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHF;AAID;;AAEM,SAASxD,UAAT,CAAoBgE,UAApB,EAAgCJ,IAAhC,EAAsC7B,EAAtC,EAAyC;AAC9CJ,UAAQ,QAAR,EAAkB,eAAaqC,UAAb,GAAwB,YAAxB,GAAqCJ,IAAvD,EACCC,SADD,EACY,UAAC5B,GAAD,EAAO;AAChBF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHF;AAID;;AAEM,SAASvD,YAAT,CAAsBgE,UAAtB,EAAkCL,IAAlC,EAAwC7B,EAAxC,EAA2C;AAChDJ,UAAQ,KAAR,EAAe,mBAAmBsC,UAAnB,GAAgC,YAAhC,GAA+CL,IAA9D,EACCC,SADD,EACY,UAAC5B,GAAD,EAAS;AAClBF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHF;AAID;;AAEM,SAAStD,cAAT,CAAwB+D,UAAxB,EAAoCL,IAApC,EAA0C7B,EAA1C,EAA6C;AAClDJ,UAAQ,QAAR,EAAkB,mBAAmBsC,UAAnB,GAA+B,YAA/B,GAA8CL,IAAhE,EACCC,SADD,EACY,UAAC5B,GAAD,EAAS;AAClBF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHF;AAID;;AAEM,SAASrD,cAAT,CAAwB+D,IAAxB,EAA8BnC,EAA9B,EAAiC;AACtCJ,UAAQ,KAAR,EAAc,oBAAkBuC,KAAKT,MAArC,EAA4CS,IAA5C,EAAiD,UAACjC,GAAD,EAAO;AACtDF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAASpD,YAAT,CAAsBwD,IAAtB,EAA2BO,GAA3B,EAA+BpC,EAA/B,EAAkC;AACvCJ,UAAQ,KAAR,EAAc,2BAAyBiC,IAAvC,EAA4C,EAAC,OAAMO,GAAP,EAA5C,EAAwD,UAAClC,GAAD,EAAO;AAC7DF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAASnD,WAAT,CAAqB6D,IAArB,EAA0BnC,EAA1B,EAA6B;AAClCJ,UAAQ,KAAR,EAAc,gCAA8BuC,KAAKT,MAAjD,EAAyDS,IAAzD,EAA8D,UAACjC,GAAD,EAAO;AACnEF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAGM,SAASlD,WAAT,CAAqB0D,UAArB,EAAiCI,MAAjC,EAAyCC,OAAzC,EAAkDtC,EAAlD,EAAqD;AAC1DJ,UAAQ,MAAR,EAAe,eAAaqC,UAAb,GAAwB,wBAAvC,EAAgE;AAC9DI,YAAOA,MADuD;AAE9DE,UAAKD;AAFyD,GAAhE,EAGE,UAACpC,GAAD,EAAO;AACPF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GALD;AAMD;;AAEM,SAASjD,UAAT,CAAoBqD,IAApB,EAA0BU,IAA1B,EAAgCH,GAAhC,EAAqCpC,EAArC,EAAwC;AAC7CtC,cAAY,UAAC8E,GAAD,EAAO;AACjB5C,YAAQ,MAAR,EAAgB,WAAhB,EAA6B;AAC3B8B,cAAOG,IADoB;AAE3BU,YAAKA,IAFsB;AAG3BH,WAAKA,GAHsB;AAI3BT,gBAASa,QAAM,OAAN,IAAeA,IAAIhC,MAAJ,KAAa,IAA5B,IAAoCgC,IAAIC,OAAJ,CAAYC,MAAZ,GAAmB,CAAvD,GAA2DF,IAAIC,OAAJ,CAAY,CAAZ,CAA3D,GAA4E;AAJ1D,KAA7B,EAKG,UAACvC,GAAD,EAAO;AACRF,SAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,KAPD;AAQD,GATD;AAUD;;AAGM,SAAShD,cAAT,CAAwB0D,IAAxB,EAA6BnC,EAA7B,EAAgC;AACnCJ,UAAQ,MAAR,EAAe,eAAf,EAA+B;AAC1B,YAAQuC,KAAKQ,IADa;AAE1B,cAASR,KAAKS,QAAL,CAAcC,GAFG;AAG1B,aAASV,KAAKW,KAHY;AAI1B,mBAAcX,KAAKY,WAJO;AAK1B,WAAMZ,KAAKC,GAAL,KAAa,IAAb,GAAoB,mBAApB,GAA0CD,KAAKC,GAL3B;AAM1B,iBAAa1C,OAAOyC,KAAKa,SAAZ,EAAuBC,OAAvB,EANa;AAO1B,eAAWvD,OAAOyC,KAAKe,OAAZ,EAAqBD,OAArB,EAPe;AAQ1B,gBAAYd,KAAKR,QARS;AAS1B,gBAAY;AACV,cAAQQ,KAAKgB;AADH;AATc,GAA/B,EAaE,UAACjD,GAAD,EAAS;AACTF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAfD;AAiBH;;AAGM,SAAS/C,eAAT,CAAyBmD,IAAzB,EAA+B7B,EAA/B,EAAkC;AACvC;AACAJ,UAAQ,KAAR,EAAe,WAASiC,IAAT,GAAc,OAA7B,EAAsCC,SAAtC,EAAiD,UAAC5B,GAAD,EAAS;AACxD;AACAF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHD;AAKD;;AAEM,SAAS9C,mBAAT,CAA6BkD,IAA7B,EAAkC7B,EAAlC,EAAqC;AAC1C;AACAJ,UAAQ,KAAR,EAAe,WAAWiC,IAAX,GAAkB,WAAjC,EAA8CC,SAA9C,EAAyD,UAAC5B,GAAD,EAAS;AAChE;AACAF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHD;AAID;;AAEM,SAAS7C,gBAAT,CAA0BiD,IAA1B,EAA+B7B,EAA/B,EAAkC;AACvC;AACAJ,UAAQ,KAAR,EAAe,WAAWiC,IAAX,GAAkB,aAAjC,EAAgDC,SAAhD,EAA2D,UAAC5B,GAAD,EAAS;AAClE;AACAF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHD;AAID;;AAEM,SAAS5C,WAAT,CAAqBuE,IAArB,EAA0BvB,IAA1B,EAA+B7B,EAA/B,EAAkC;AACvC;AACAJ,UAAQ,KAAR,EAAe,WAAWiC,IAAX,GAAkB,SAAlB,GAA4BuB,IAA3C,EAAiDtB,SAAjD,EAA4D,UAAC5B,GAAD,EAAS;AACnE;AACAF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAHD;AAID;;AAEM,SAAS3C,WAAT,CAAqB+C,IAArB,EAA0B7B,EAA1B,EAA6B;AAClCJ,UAAQ,KAAR,EAAc,WAASiC,IAAvB,EAA4BC,SAA5B,EAAsC,UAAC5B,GAAD,EAAO;AAC3CF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAAS1C,iBAAT,CAA2B6C,EAA3B,EAA8B5B,EAA9B,EAAiC;AACtCJ,UAAQ,KAAR,EAAc,mBAAiBgC,EAA/B,EAAmCE,SAAnC,EAA8C,UAAC5B,GAAD,EAAS;AACrDF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAASzC,aAAT,CAAuBkD,UAAvB,EAAmCG,MAAnC,EAA2CC,OAA3C,EAAoDtC,EAApD,EAAuD;AAC5DJ,UAAQ,MAAR,EAAe,mBAAiBsC,UAAjB,GAA4B,wBAA3C,EAAoE;AAClEG,YAAOA,MAD2D;AAElEE,UAAKD;AAF6D,GAApE,EAGE,UAACpC,GAAD,EAAO;AACPF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GALD;AAMD;;AAEM,SAASxC,WAAT,CAAqBmE,IAArB,EAA0BC,MAA1B,EAAiCzB,EAAjC,EAAoC5B,EAApC,EAAuC;AAC5CJ,UAAQ,KAAR,EAAc,WAASyD,MAAT,GAAgB,eAAhB,GAAgCzB,EAAhC,GAAmC,GAAnC,GAAuCwB,IAArD,EAA2DtB,SAA3D,EAAsE,UAAC5B,GAAD,EAAS;AAC7EF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAEM,SAASvC,WAAT,CAAqBoE,SAArB,EAA+BC,MAA/B,EAAsCC,MAAtC,EAA8CjB,IAA9C,EAAoDvC,EAApD,EAAuD;AAC5DJ,UAAQ,MAAR,EAAe,WAAS2D,MAAT,GAAgB,eAAhB,GAAgCD,SAA/C,EAAyD;AACvDC,YAAOA,MADgD;AAEvDC,YAAOA,MAFgD;AAGvDjB,UAAKA;AAHkD,GAAzD,EAIE,UAACrC,GAAD,EAAO;AACPF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAND;AAOD;;AAEM,SAAStC,YAAT,CAAsBkE,MAAtB,EAA6BI,QAA7B,EAAsCzD,EAAtC,EAAyC;AAC9CJ,UAAQ,KAAR,EAAc,iBAAeyD,MAAf,GAAsB,GAAtB,GAA0BI,QAAxC,EAAkD3B,SAAlD,EAA6D,UAAC5B,GAAD,EAAS;AACpEF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAIM,SAASrC,WAAT,CAAqBiE,MAArB,EAA4BK,SAA5B,EAAsC1D,EAAtC,EAAyC;AAC9CJ,UAAQ,KAAR,EAAc,oBAAkByD,MAAlB,GAAyB,aAAzB,GAAuCK,SAArD,EAAgE5B,SAAhE,EAA2E,UAAC5B,GAAD,EAAS;AAClFF,OAAGW,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAH;AACD,GAFD;AAGD;;AAGO,SAASpC,MAAT,CAAgBsE,KAAhB,EAAuBC,QAAvB,EAAiCC,QAAjC,EAA2C7D,EAA3C,EAA+C;AACpDJ,UAAQ,MAAR,EAAgB,SAAhB,EAA2B,EAAEkE,UAAUF,QAAZ;AACAD,WAAOA,KADP;AAEAE,cAAUA,QAFV,EAA3B,EAEiD,YAAM;AACrD7D,OAAG,IAAH;AACD,GAJD,EAIG,YAAM;AACPA,OAAG,KAAH;AACD,GAND;AAOD;;AAEM,SAASV,KAAT,CAAeqE,KAAf,EAAsBE,QAAtB,EAAgC7D,EAAhC,EAAoC;AAC1CJ,UAAQ,MAAR,EAAgB,QAAhB,EAA0B,EAAE+D,OAAOA,KAAT,EAAgBE,UAAUA,QAA1B,EAA1B,EACA,UAAC3D,GAAD,EAAS;AACP;AACA,QAAI6D,WAAWpD,KAAKa,KAAL,CAAWtB,IAAIuB,YAAf,CAAf;AACA;AACA,wCAAkBsC,SAASlC,IAA3B,EAAiCkC,SAASC,KAA1C;AACAhE,OAAG,IAAH;AACD,GAPD,EAOG,YAAM;AACP;AACAA,OAAG,KAAH;AACD,GAVD;AAWD;;AAEM,SAAST,SAAT,CAAmBgE,MAAnB,EAA0BC,MAA1B,EAAiCxD,EAAjC,EAAoC;AACzCJ,UAAQ,MAAR,EAAe,oBAAkB2D,MAAlB,GAAyB,GAAzB,GAA6BC,MAA5C,EAAmD1B,SAAnD,EAA6D,YAAI;AAC/D9B,OAAG,IAAH;AACD,GAFD,EAEE,YAAI;AACJA,OAAG,KAAH;AACD,GAJD;AAKD;;AAEM,SAASR,uBAAT,CAAiC+D,MAAjC,EAAwCC,MAAxC,EAA+CS,UAA/C,EAA0DjE,EAA1D,EAA6D;AAClEJ,UAAQ,MAAR,EAAe,0BAAwB2D,MAAxB,GAA+B,GAA/B,GAAmCC,MAAnC,GAA0C,GAA1C,GAA8CS,UAA7D,EAAwEnC,SAAxE,EAAkF,YAAI;AACpF9B,OAAG,IAAH;AACD,GAFD,EAEE,YAAI;AACJA,OAAG,KAAH;AACD,GAJD;AAKD;;AAEM,SAASP,yBAAT,CAAmC8D,MAAnC,EAA0CC,MAA1C,EAAiDS,UAAjD,EAA4DjE,EAA5D,EAA+D;AACpEJ,UAAQ,MAAR,EAAe,4BAA0B2D,MAA1B,GAAiC,GAAjC,GAAqCC,MAArC,GAA4C,GAA5C,GAAgDS,UAA/D,EAA0EnC,SAA1E,EAAoF,YAAI;AACtF9B,OAAG,IAAH;AACD,GAFD,EAEE,YAAI;AACJA,OAAG,KAAH;AACD,GAJD;AAKD","file":"server.js","sourceRoot":"C:/Users/Vincent/Desktop/wemeet/client","sourcesContent":["import {} from './component/database.js';\r\n// var token = 'eyJpZCI6IjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSJ9';\r\nvar moment = require('moment');\r\nimport {updateCredentials,getToken} from './credentials';\r\n\r\n/**\r\n* Properly configure+send an XMLHttpRequest with error handling,\r\n* authorization token, and other needed properties.\r\n*/\r\nfunction sendXHR(verb, resource, body, cb, errorCb) {\r\n  var xhr = new XMLHttpRequest();\r\n  xhr.open(verb, resource);\r\n  xhr.setRequestHeader('Authorization', 'Bearer ' + getToken());\r\n  // The below comment tells ESLint that AppError is a global.\r\n  // Otherwise, ESLint would complain about it! (See what happens in Atom if\r\n  // you remove the comment...)\r\n  // global AppError //\r\n  // Response received from server. It could be a failure, though!\r\n  xhr.addEventListener('load', function() {\r\n    var statusCode = xhr.status;\r\n    // var statusText = xhr.statusText;\r\n    if (statusCode >= 200 && statusCode < 300) {\r\n      // Success: Status code is in the [200, 300) range.\r\n      // Call the callback with the final XHR object.\r\n      cb(xhr);\r\n    } else {\r\n      // Client or server error.\r\n      // The server may have included some response text with details concerning\r\n      // the error.\r\n      // var responseText = xhr.responseText;\r\n      if (errorCb) {\r\n        // We were given a custom error handler.\r\n        errorCb(statusCode);\r\n      }\r\n      // window.AppError('Could not ' + verb + \" \" + resource + \": Received \" +\r\n      // statusCode + \" \" + statusText + \": \" + responseText);\r\n    }\r\n  });\r\n  // Time out the request if it takes longer than 10,000\r\n  // milliseconds (10 seconds)\r\n  xhr.timeout = 10000;\r\n  // Network failure: Could not connect to server.\r\n  // xhr.addEventListener('error', function() {\r\n  //   window.AppError('Could not ' + verb + \" \" + resource +\r\n  //   \": Could not connect to the server.\");\r\n  // });\r\n  // Network failure: request took too long to complete.\r\n  // xhr.addEventListener('timeout', function() {\r\n  //   window.AppError('Could not ' + verb + \" \" + resource +\r\n  //   \": Request timed out.\");\r\n  // });\r\n  switch (typeof(body)) {\r\n    case 'undefined':\r\n      // No body to send.\r\n      xhr.send();\r\n    break;\r\n      case 'string':\r\n      // Tell the server we are sending text.\r\n      xhr.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\r\n      xhr.send(body);\r\n    break;\r\n      case 'object':\r\n      // Tell the server we are sending JSON.\r\n      xhr.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n      // Convert body into a JSON string.\r\n      xhr.send(JSON.stringify(body));\r\n    break;\r\n      default:\r\n      throw new Error('Unknown body type: ' + typeof(body));\r\n  }\r\n}\r\n\r\nexport function getlocation(cb){\r\n  if (/Edge\\/\\d./i.test(navigator.userAgent)){\r\n    return cb(\"error\");\r\n  }\r\n  if (\"geolocation\" in navigator) {\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open('GET',\r\n      'https://maps.googleapis.com/maps/api/geocode/json?latlng='+position.coords.latitude+\",\"+position.coords.longitude+'&sensor=true');\r\n      xhr.onload = function() {\r\n        cb(JSON.parse(xhr.responseText));\r\n      }\r\n      xhr.send();\r\n    });\r\n  }\r\n  else{\r\n    cb(\"Google is banned\");\r\n  }\r\n}\r\n\r\nexport function setlocation(userId,location){\r\n  sendXHR('PUT','/settings/location/user/'+userId,location,()=>{\r\n  });\r\n}\r\n\r\n\r\nexport function deleteNotification(id, user ,cb){\r\n  sendXHR('DELETE','/notification/'+id+'/'+user,undefined,(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function acceptFriendRequest(id,user,cb){\r\n  sendXHR('PUT','/notification/'+id+'/'+user,undefined,(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function acceptActivityRequest(notificationid,fromuser,cb){\r\n  sendXHR('PUT','/acceptactivity/'+notificationid+'/'+fromuser,undefined,(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  })\r\n}\r\n\r\nexport function getNotificationData(user, cb){\r\n  sendXHR('GET','/user/'+user+'/notification',undefined,(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function likePost(feedItemId, user, cb){\r\n  sendXHR('PUT', '/postItem/'+feedItemId+'/likelist/'+user,\r\n   undefined, (xhr)=>{\r\n     cb(JSON.parse(xhr.responseText));\r\n   });\r\n}\r\n\r\nexport function unLikePost(feedItemId, user, cb){\r\n  sendXHR('DELETE', '/postItem/'+feedItemId+'/likelist/'+user,\r\n   undefined, (xhr)=>{\r\n     cb(JSON.parse(xhr.responseText));\r\n   });\r\n}\r\n\r\nexport function likeActivity(activityId, user, cb){\r\n  sendXHR('PUT', '/activityItem/' + activityId + '/likelist/' + user,\r\n   undefined, (xhr) => {\r\n     cb(JSON.parse(xhr.responseText));\r\n   });\r\n}\r\n\r\nexport function unLikeActivity(activityId, user, cb){\r\n  sendXHR('DELETE', '/activityItem/' + activityId +'/likelist/' + user,\r\n   undefined, (xhr) => {\r\n     cb(JSON.parse(xhr.responseText));\r\n   });\r\n}\r\n\r\nexport function changeUserInfo(data, cb){\r\n  sendXHR('PUT','/settings/user/'+data.userId,data,(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  })\r\n}\r\n\r\nexport function ChangeAvatar(user,img,cb){\r\n  sendXHR('PUT','/settings/avatar/user/'+user,{\"img\":img},(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function changeEmail(data,cb){\r\n  sendXHR('PUT','/settings/emailChange/user/'+data.userId, data,(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  })\r\n}\r\n\r\n\r\nexport function postComment(feedItemId, author, comment, cb){\r\n  sendXHR('POST','/postItem/'+feedItemId+'/commentThread/comment',{\r\n    author:author,\r\n    text:comment\r\n  },(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  })\r\n}\r\n\r\nexport function postStatus(user, text, img, cb){\r\n  getlocation((res)=>{\r\n    sendXHR('POST', '/postItem', {\r\n      userId:user,\r\n      text:text,\r\n      img: img,\r\n      location:res!==\"error\"&&res.status===\"OK\" && res.results.length>0 ? res.results[0] : {}\r\n    }, (xhr)=>{\r\n      cb(JSON.parse(xhr.responseText));\r\n    });\r\n  });\r\n}\r\n\r\n\r\nexport function createActivity(data,cb){\r\n    sendXHR('POST','/postActivity',{\r\n         \"type\": data.type,\r\n         \"author\":data.userData._id,\r\n         \"title\": data.title,\r\n         \"description\":data.description,\r\n         \"img\":data.img === null ? \"./img/default.png\" : data.img,\r\n         \"startTime\": moment(data.startTime).valueOf(),\r\n         \"endTime\": moment(data.endTime).valueOf(),\r\n         \"location\": data.location,\r\n         \"contents\": {\r\n           \"text\": data.detail\r\n          }\r\n      }\r\n    , (xhr) => {\r\n      cb(JSON.parse(xhr.responseText));\r\n    });\r\n\r\n}\r\n\r\n\r\nexport function getPostFeedData(user, cb){\r\n  // We don't need to send a body, so pass in 'undefined' for the body.\r\n  sendXHR('GET', '/user/'+user+'/feed', undefined, (xhr) => {\r\n    // Call the callback with the data.\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n\r\n}\r\n\r\nexport function getActivityFeedData(user,cb){\r\n  // We don't need to send a body, so pass in 'undefined' for the body.\r\n  sendXHR('GET', '/user/' + user + '/activity', undefined, (xhr) => {\r\n    // Call the callback with the data.\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function getAllActivities(user,cb){\r\n  // We don't need to send a body, so pass in 'undefined' for the body.\r\n  sendXHR('GET', '/user/' + user + '/activities', undefined, (xhr) => {\r\n    // Call the callback with the data.\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function getAllPosts(time,user,cb){\r\n  // We don't need to send a body, so pass in 'undefined' for the body.\r\n  sendXHR('GET', '/user/' + user + '/posts/'+time, undefined, (xhr) => {\r\n    // Call the callback with the data.\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function getUserData(user,cb){\r\n  sendXHR('GET','/user/'+user,undefined,(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  })\r\n}\r\n\r\nexport function getActivityDetail(id,cb){\r\n  sendXHR('GET','/activityItem/'+id, undefined, (xhr) => {\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function adpostComment(activityId, author, comment, cb){\r\n  sendXHR('POST','/activityItem/'+activityId+'/commentThread/comment',{\r\n    author:author,\r\n    text:comment\r\n  },(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  })\r\n}\r\n\r\nexport function getMessages(time,userid,id,cb){\r\n  sendXHR('GET','/user/'+userid+'/chatsession/'+id+\"/\"+time, undefined, (xhr) => {\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\nexport function postMessage(sessionId,sender,target, text, cb){\r\n  sendXHR('POST','/user/'+sender+'/chatsession/'+sessionId,{\r\n    sender:sender,\r\n    target:target,\r\n    text:text\r\n  },(xhr)=>{\r\n    cb(JSON.parse(xhr.responseText));\r\n  })\r\n}\r\n\r\nexport function getSessionId(userid,targetid,cb){\r\n  sendXHR('GET','/getsession/'+userid+'/'+targetid, undefined ,(xhr) => {\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\n\r\n\r\nexport function searchquery(userid,querytext,cb){\r\n  sendXHR('GET','/search/userid/'+userid+'/querytext/'+querytext, undefined, (xhr) => {\r\n    cb(JSON.parse(xhr.responseText));\r\n  });\r\n}\r\n\r\n\r\n export function signup(email, username, password, cb) {\r\n   sendXHR('POST', '/signup', { fullname: username,\r\n                              email: email,\r\n                              password: password }, () => {\r\n     cb(true);\r\n   }, () => {\r\n     cb(false);\r\n   });\r\n }\r\n\r\n export function login(email, password, cb) {\r\n  sendXHR('POST', '/login', { email: email, password: password},\r\n  (xhr) => {\r\n    // Success callback: Login succeeded.\r\n    var authData = JSON.parse(xhr.responseText);\r\n    // Update credentials and indicate success via the callback!\r\n    updateCredentials(authData.user, authData.token);\r\n    cb(true);\r\n  }, () => {\r\n    // Error callback: Login failed.\r\n    cb(false);\r\n  });\r\n}\r\n\r\nexport function addFriend(sender,target,cb){\r\n  sendXHR('POST','/friendRequest/'+sender+\"/\"+target,undefined,()=>{\r\n    cb(true);\r\n  },()=>{\r\n    cb(false);\r\n  });\r\n}\r\n\r\nexport function sendJoinActivityRequest(sender,target,activityid,cb){\r\n  sendXHR('POST','/activityJoinRequest/'+sender+'/'+target+'/'+activityid,undefined,()=>{\r\n    cb(true);\r\n  },()=>{\r\n    cb(false);\r\n  })\r\n}\r\n\r\nexport function sendInviteActivityRequest(sender,target,activityid,cb){\r\n  sendXHR('POST','/activityInviteRequest/'+sender+'/'+target+'/'+activityid,undefined,()=>{\r\n    cb(true);\r\n  },()=>{\r\n    cb(false);\r\n  })\r\n}\r\n"]}